\section{Semantic \aclp{ts}}
\label{sec:tsc_soa}

% Añadir  Citron (2005)? (eoa de Almeida)
% Tanasescu
% swarm
% decir que tiene mucho que ver con distributed triple stores
% analizarlos también??? vaya pereza! -> igual comentar diferencia y dejar el análisis para la sección tosca de IGWS

Semantic \aclp{ts} aim to join \aclp{ts} with the \acl{sw} to propose a more uncoupled solution.
Particularly, it benefits from the autonomies introduced by both \ac{ts} and the \ac{sw}:

\begin{itemize}
  \item Space uncoupling.
  \item Time uncoupling.
  \item Data-schema uncoupling. % explicar?
% 	enhances the interoperability of the
% 	applications built on top of TSC. This way, two applications using standard ontologies can interact among them
% 	automatically enriching one each other, as long as they use the same space and standard and linked ontologies.
\end{itemize}


In this section we provide a review of the existing Semantic \aclp{ts} solutions. % citar nixon_tuplespace-based_2008 ???
To summarize, we present a comparison of them at the end of the section, analyzing their limitations.


\InsertFig{venn-sec3}{fig:venn_tuplespaces_semantics}{
  Semantic \aclp{ts}.
}{
  Scope of this section.
}{0.6}{}


\subsection{TSC}
% modelo propuesto
TSC \citep{fensel_tsc_2007} is the middleware which first implemented the ideas of Fensel et al. \citep{fensel_triple-space_2004}.
TSC explores a \acl{tsc} infrastructure based on the \ac{rest} architectural style.
Equivalently to \ac{rest}, TSC proposes a stateless infrastructure where the resources are identified by \acp{uri}.
In the first approximation, each tuple was considered a resource.
These tuples correspond with \ac{rdf} triples.
In a later work,  Krummenacher et al. \citep{krummenacher2006specification} proposed to use identifiers just for a set of triples (i.e. \ac{rdf} graphs).
% bundler cita el de "WWW: or what's wrong with the web" para explicar eso último
They argue that resources usually need to be modeled using more than just a triple.
Besides, the use of graphs reduces the complexity on storage.
To cope with the heterogeneity of data and scalability issues, they propose the use of independent spaces identified by their own \ac{uri}.
Using these disjoint spaces, they can restrict the number of participant in each one.


% cosas relativas al despliegue
TSC combines client/server and \ac{p2p} architectures using a hybrid super-peer one.
The super-peers of this architecture communicate with each other using a middleware which offers a virtual shared memory space of Java objects.
They present 3 different types of nodes:
\begin{itemize}
  \item The \emph{servers} are the responsible for storing and replicating the spaces.
  \item The \emph{heavy clients} are not always connected to the system, but they have the same responsibilities as the \emph{servers}.
	They can work off-line with their replicas.
  \item The \emph{light clients} can access to the spaces using proxies or an \ac{http} \acs{api}.
\end{itemize}


% arquitectura
TSC consist of three main components: a mediation engine, a data access layer and a coordination layer.
The mediation engine manages data heterogeneity by intermediating between nodes using different data schemas.
The data access layer ensures persistence of data, supports template matching and provides some reasoning over the knowledge stored.
The coordination layer replicates named graphs to all involved TS kernels and therefore has to be synchronized with the data access.
% http://tsc.deri.at/deliverables/D21.html
% http://tsc.deri.at/deliverables/D31/D31.html
To do that, they use a \ac{p2p} implementation of a virtual shared data space. % cita a CORSO?
% decir que ofrece transaccionalidad gracias a CORSO? transactionality
% It also offers a transactional context and a simple form to publish and subscribe to certain patterns.



\subsection{Semantic Web Spaces}

% modelo propuesto
Semantic Web Spaces (SWS) \citep{tolksdorf_coordination_2006} defines two different data coordination views: data view and information view.
In both views the tuples are represented with three fields which correspond with \ac{rdf} triples' subject, predicate and object.
The data view stores syntactically valid \ac{rdf} and it is accessed using Linda primitives.
The information view stores consistent and satisfiable data which are managed using new primitives.
This view takes into account the knowledge defined by ontologies to perform semantic matching over inferred triples.

% cosas relativas al despliegue
SWS are virtually partitioned using contexts, which provide a simple form of access control.
Clients can allocate contexts to control their view privately or share it with other clients. % This allow clustering ¿WTF?
The different active spaces and the tuples they contain are represented in a meta-space using a meta-model ontology.
This ontology also allows to express the hierarchical relation between the spaces and security policies.
% por lo que entiendo, está centralizadísimo

% arquitectura
The prototype contains three main components: publication, retrieval and security.
The publication component describes how the platform communicates with the clients or storage managers.
The retrieval component process queries and can reason to enhance results. % no se razona cada vez que se inserta una tupla
The security component restrict the access of client to spaces according to the policies defined.  % hablan de agentes
% dicen que experimentaron problemas de escalabilidad



\subsection{sTuples}

% modelo propuesto
STuples \citep{khushraj_stuples:_2004} was conceived by Nokia Research Center as a pervasive computing work.
It extends the JavaSpace middleware, a object-oriented \acl{ts}, using a semantic match over the semantic tuples.
To do that, a semantic tuple is an object with a field with the semantic description in the DAML+OIL format. % definir DAML+OIL o citarlo?


% cosas relativas al despliegue
The space is centralized and uses a framework called Vigil to create clients and services. % cita Vigil?
Vigil acts as a communication gateway with several protocols and it is directly integrated with sTuples.


% arquitectura
The JavaSpace extension is done in sTuples through two components: the Tuple Manager and the Tuple Matcher.
The manager adds, removes or states changes of tuples.
Every insertion requires the semantic data to be asserted.
The matcher implements the algorithm to match templates.
Besides, specialized agents reside on the space to offer added functionality to the users.
For instance, they implemented recommendations, subscriptions and task-executions in their prototype.



\subsection{Conceptual Spaces}

% modelo propuesto
Conceptual Spaces, or CSpaces, were born to study the applicability of semantic \aclp{ts} to different scenarios including \acl{ubicomp}.
Tuples in CSpaces contain seven different fields.
Some fields enable to express logic theories using different formal languages.
Other remarkable fields are used to define the version, specify the creator or to define to which subspaces the tuple belongs. % explicar los 7 campos?

% cosas relativas al despliegue
The spaces in CSpaces can be individual or shared.
An individual space belongs to a single process.
A shared one allows access to all the processes who have agreed on.

% arquitectura
%Es una IDEA y NO la habían IMPLEMENTADO (posteriormente hicieron un prototipo limitado para un paper de 2006).
CSpaces differentiates between the same three types of nodes as TSC.
They intended to implement individual spaces in heavy-clients and shared spaces in servers.
They first considered a centralized implementation for the shared-spaces, % lo dicen en la comparativa
and later on a P2P network of the nodes managing a shared-space. % paper de después
In any case, to the best of our knowledge, this conceptual exercise never went beyond a rather limited prototype.
% TODO confirmar 100%



\subsection{tsc++}

% modelo propuesto
Tsc++ \citep{krummenacher_open_2009,blunder_distributed_2009} is a new version of the TSC project.
Therefore, although the model is equivalent to TSC, its implementation completely changes.


% cosas relativas al despliegue
% Páginas 54 y 55
Instead of replicating each space in the different kernels as TSC does, tsc++ proposes to divide the spaces among the participants.
Therefore, a space corresponds with a group a nodes on the \emph{Jxta} \ac{p2p} framework \footnote{https://jxta.dev.java.net/}. % jxta de otra forma?
These nodes write their information locally and discover information in other nodes using some special nodes.
This special nodes in Jxta are called \emph{rendezvous} (RDV).
Tsc++ proposes and evaluates two discovery algorithms: flooding and random walk (RDW).
\begin{itemize}
  \item The flooding algorithm sends the request to a RDV, which propagates it to all the known nodes.
	If this nodes are RDV, they may propagate the request until a number of maximum hops is reached.
  \item The RDW algorithm chooses one peer to send the message to after the request has been processed in the current one.
	In Tsc++ the request is sent to a RDV which creates a list of all the nodes and sends it to the first one in the list.
	At each step a new node from that list will be chosen.
	Besides, the \emph{walk} ends when a result is returned or when a maximum number of hops is reached if no response was found.
\end{itemize}
% De dónde leches saqué esto de NB?
%These nodes follow a simple flooding-based strategy to distribute their information called \emph{negative broadcasting}.
%In negative broadcasting each node writes the information locally and read querying to the rest of the nodes of the space.


% arquitectura
Tsc++ has 3 main components: the communication and the data access.
The data access layer relies on a semantic repository to perform queries and store the triples.
% mencionar que son Sesame \citep{broekstra_sesame:_2002} y Owlim \citep{kiryakov_owlimpragmatic_2005} ???
The communication layer maps the reading coordination primitives to group communication.
% No evaluan el mecanismo de subscripción porque dicen que se basa en DHT y que como es escalable no necesita más evaluación
% No me queda claro de qué forma usan DHT sobre los nodos RDV que son los que miran las subscripciones cómo están.
Besides, it offers a subscription mechanism independent to the content stored in the space which uses triples and templates as a basis.


% it does not make inference
% it does not allow expressive querying
% it has not been designed for devices with reduced computing capabilities, because tsc++ middleware focused on architecture and implementation in large scale and we focus in the short scale (local area networks with an intelligent environment).



\subsection{Triple Space Communication (TripCom)}

% modelo propuesto
TripCom\footnote{TripCom (IST-4-027324-STP, www.tripcom.org)} is a Triple Space solution which works with \ac{rdf} triples as resources.
The most remarkable aspects of the model proposed by TripCom are:
\begin{itemize}
  \item The use of subspaces to form form nested multiple spaces.
	Using them it restricts the communication to a part of the whole space.
	This restriction leads to local scalability and completeness.
  \item A mechanism to overlap spaces called \emph{scopes}.
	Using the scopes a client can have a temporary copy of some tuples.
	However, any insertion and deletion would not apply to the whole Triple Space.
  \item A meta-space to describe the relations between spaces or to which graph a tuple belongs.
  \item Different types of templates can be used to query the space, from simple wildcard-based templates to more expressive SPARQL queries.
  \item New primitives: read at triple or a graph level and writing multiple triples at once.
  \item A subscription mechanism.
\end{itemize}


% cosas relativas al despliegue
To access to a space a client needs to contact a TripCom instance, i.e. kernel.
% TODO Duda inglés, está bien hecho eso de "sujeto verbo objeto and verbo" o debería ser "sujeto verbo objeto and sujeto verbo objeto"???
% TODO Uniformizarlo a lo largo del texto
Each kernel stores one or more subspaces and can contact other kernels responsible for different spaces.
To do that, if the space \ac{url} is provided, it simply resolves this \ac{url} using \ac{dns} to contact the other kernel.
Otherwise, the kernel uses 4 different strategies:
\begin{itemize}
  \item Triple Provider. It uses shortcuts to know who answered a query in the past.
  \item Recommender. It uses shortcuts to know which kernel successfully routed a query in the past.
  \item Indexing - \ac{dht}.
	It creates indexes using a hash function over the subject, predicate, object and space \ac{url}.
	Then, it stores these indexes in a distributed database which relies in a structured \ac{p2p} system. % mencionar PGrid???
\end{itemize}


% arquitectura
A TripCom kernel has several components which communicate with each other using a \acl{ts} solution.
The most important components regarding how the triples are distributed are:
\begin{itemize}
  \item Triple Store Adapter.
	It acts as a gateway with the selected repository.
  \item Query Processor. It descomposes query into subqueries.
	Then, to answer each subquery the kernel: a) queries the local data store or b) forwards it to other kernel.
  \item Distribution Manager.
	Forwards queries or write requests to the appropiate kernels.
\end{itemize}
Apart from these, there are also security, mediation, metadata and transaction managers.
On top of these components, TripCom offers three different \acp{api}:
Triple Space \acs{api} to map the primitives,
web service \acs{api}, which offers higher level service consumption \acs{api}
and management \acs{api} to configure the each kernel.



\subsection{Smart-M3}

% modelo propuesto
Smart-M3 is an open-source distributed middleware which uses \ac{rdf} graphs. % CITA
It supports three types of primitives: \acl{ts}-based primitives, subscriptions and a query over a whole space.
Smart-M3 defines two types of nodes: Semantic Information Brokers (SIB) and Knowledge Processors (KP).
The SIBs store the knowledge and perform reasoning process on behalf of the KPs.
A KP access to a SIB using two different types of interfaces (called KPI):
\begin{itemize}
  \item The low-level API uses triples as a base.
  \item The high-level API allows the developer to use ontological entities such as classes, relations and individuals.
\end{itemize}


% cosas relativas al despliegue
The space can be distributed over more than a SIB using a \emph{distributed deductive closure}. % CITA?
However, to the best of our knowledge no evaluation with more than a SIB has been presented yet, making it de facto an centralized space.
For the communication between SIBs and KPs, Smart-M3 defines a protocol called \emph{Smart Access Protocol (SSAP)}.
SSAP can be implemented on top of different communication mechanisms (e.g. SOA, XMPP, Bluetooth or TCP/IP) making the solution communication agnostic. % TODO acrónimos?


% arquitectura
A SIB is divided in 5 layers: transport, request handling, graph operations, triple operation and persistent store.
The transport layer has different processes for each communication mechanism supported.
Once the SSAP operations have been extracted, the request handling creates a thread for each primitive.
The graph operations work with primitives using \ac{rdf} graphs and communicates with triple operations.
In the triple operation, expressive queries may need to be translated to query the store.
% decir que también soporta subscripción?

% dibujo?

% De: http://www.diem.fi/files/KP_reference%20implementation.pdf
%  The Semantic Information Broker is the information repository of the Smart 
%  Environment. In theory, the Smart-M3 Smart Space can consist of one or more SIB 
%  entities. However, the SIB reference implementation does not currently support any 
%  kind of interaction between different SIBs, which would enable distribution of the 
%  Smart Space. On the IOP, the SIB is implemented as a NoTA SN.



\subsection{Nardini et al.}

% modelo propuesto
\citet{nardini_semantic_2013} explores the use of Description Logics on top of an existing \emph{tuple centre} implementation called TuCSoN. % TODO CITA
A tuple centre is a tuple space where the behavior can be programmed as a result of the basic coordination primitives.
TuCSoN aims to provide \emph{tuple centres} that agents can use through Linda-type primitives.
This interaction can cause reactions which trigger behavior previously implemented in the \emph{tuple centre}.

% cosas relativas al despliegue
In TuCSoN each \emph{tuple centre} is deployed in device's port and it is identified by a name.
The communication with each centre is direct, not based in any underlying network. % no les mola P2P decian en algun lado
The agents can access to remote \emph{tuple centres} and migrate to them, but these interactions need to be programmed.

% arquitectura
Nardini et al. defines a domain ontology attached to each centre to provide semantic interpretation to the tuples stored.
They extend TuCSoN providing semantic tuples, templates, primitives, reactions and matching mechanism.
\begin{itemize}
  \item The semantic tuples express the logic terms.
  \item The semantic template defines a language based on logic.
  \item To discriminate common syntactic primitives from semantic ones they use a keyword.
  \item The semantic reactions redefine events, guards and reactions enabling the use of first-order-logic.
	The events define when a reaction should be triggered.
	The reaction guard represent a set of conditions which need to be satisfied to execute a reaction.
  \item For the semantic matching mechanism they integrate TuCSoN with a reasoner (Pellet). % citar pellet?
\end{itemize}



\subsection{Comparison}
% TODO CSpaces no hace más que liar el analisis, me planteo no incluirlo
%		Porque es muy bonito poner ideas felices, pero no ha sido implementado nunca!


\subsubsection{\acl{ts} model}

A \acl{ts} model is mainly characterized by the information hold (i.e. \emph{tuple}),
how it is hold (i.e. the \emph{space} model)
and how a node can query the space (i.e. the type of \emph{query}).
The Table~\ref{tab:comparisonTS} summarizes the model used in each of the semantic \aclp{ts}.

The \emph{flat} model is the simplest manner of disjoining spaces.
Identifying this spaces with URIs, one can link them in the knowledge similarly to what other tuple models do (e.g. Nardini et al or CSpaces). % comprobar
More sophisticated models propose virtual view of spaces (i.e. scopes) or hierarchies between spaces.
Nevertheless, we argue that this models are not easy to implement in a distributed way. % extenderlo despues?

The most common tuple model is the three-field tuple with \emph{subject}, \emph{predicate} and \emph{object}.
Other solutions propose their own tuple format.
We believe that for a developer used to work with the Semantic Web the use of \ac{rdf} triples is straightforward.
Grouping these triples in \ac{rdf} graphs also provides a useful abstraction for resources.
% TODO aclarar bien porqu TSC se centra en grafos y tsc++ no!

Regarding the queries, all the solutions offer graph patterns-based queries.
These queries can be easily processed by any device, whereas complex queries need parsers.
These parsers are not always available for resource constrained platforms.
Therefore, in this thesis we focus on queries based on graph patterns.
The adoption of more complex querying languages such as SPARQL can be done as a future work. % cita SPARQL?


\input{2_state_of_the_art/tables/ts_model}



\subsubsection{Additional features}

The Table~\ref{tab:compAdds} summarizes the additional mechanisms provided by the solutions analyzed.
Most of them offer subscription mechanisms which are particularly useful for distributed environments.
% TODO modificar esto que ahora no hay implementacion!
Although this dissertation focuses more in the querying mechanism, in the Chapter~\ref{cha:implementation} we will propose a subscription mechanism.
Other solutions offer , but we have discarded its usage due to the hard implementation for distributed systems running on dynamic environments.


\input{2_state_of_the_art/tables/additional}



\subsubsection{Use of semantics}
% TODO evitar verengenales que no comprendo y que sólo me complican la vida

The Table~\ref{tab:comparisonSemantics} shows different features regarding the semantic model proposed by each solution.
First we can see how most of the solutions use the standard Semantic Web language \ac{rdf} to express knowledge.
The use of \ac{rdf} does not impose or limits the use of more advanced languages such as \ac{rdfs} or \ac{owl}.

CSpaces and Nardini et al. propose the use of a language-independent \ac{fol}.
However, since most advanced reasoners only implement a subset of \ac{fol}, any implementation is limited by them. % también estas
% theoretical counterpart of OWL DL [7]. Since OWL is the W3C standard ontology description language for the Semantic Web,
% and the standard de-facto for semantic applications in general, we adopt OWL as the ontology language for the domain
% ontologies associated to ReSpecT semantic tuple centres in TuCSoN. While for the details of OWL we forward interested

Reasoning is used both to validate the data inserted into the space or to query over inferred triples.
We do not validate the data inserted on the space to reduce the insertion time.
The possibility of querying over the inferred knowledge is limited by the availability of reasoners.
As will be shown in the next sections, nowadays there is no reasoner light enough to run in a reasonable time span in small devices.
Therefore, reasoning is not mandatory in our solution.
In any case, the use of reasoners over local content is tangential to the model proposed in this thesis.

Semantic matching is usually derived from the reasoning process.
Although it is a desirable characteristic, it is not imposed by any mean.
For our solution, describing the data semantically is a first step towards semantically interpreting it.


\input{2_state_of_the_art/tables/semantics}



\subsubsection{Distribution}
%	2. centralizado / distribuído
%	4. basado en clientes tontos

Centralized \aclp{ts} are much simpler and easier to implement.
Therefore, they usually offer more features than the distributed ones.
However, they also impose a single-point-of-failure.

This thesis aims to solve that by proposing a distributed model.
Within the distributed \aclp{ts}, a wide range of distribution strategies have been detected.
The Table~\ref{tab:comparisonDistribution} summarizes the space distribution strategy adopted by each solution.

TSC uses flooding to replicate the knowledge in all the nodes.
Tsc++ propagates the queries in flooding-based approaches.
TripCom is built on top of a structured-network which imposes where the content is stored.
The suitability of these models is subject of analysis in the Chapter~XX.

% TODO reescribir desde aquí

%In this thesis, we aim to implement a completely distributed Semantic \acl{ts}.
%In that space all the nodes should be able to participate trying to avoid any distinction between clients and servers.
%Ubicomp is be characterized for being populated by very dynamic nodes.
%This nodes usually face severe computation and energy autonomy restrictions.



% TODO y así te evitas engorrosas explicaciones aquí
%We argue that the replication is not suitable for devices with severe storage, memory and computation restrictions.
%Flooding-based queries does not scalable for spaces with many nodes, .
%Finally structured networks does not comply on

\input{2_state_of_the_art/tables/distribution}



\subsubsection{Implementations}
%	5. Implementado?
%	6. Implementación disponible
%	Interoperability
%	Multiplatform
%	8. dependencias: librerias, etc. (para decir que lo nuestro se puede implementar en casi cualquier plataforma de forma fácil)



\subsection{Conclusion}

% extraer algunas conclusiones de lo que falta
% tono general: están muy bien de características, pero a la hora de hacerlo distribuido falla
% hacen aguas en proponer un modelo que pueda ser usado más allá del client-servidor
% Suitability for Ubicomp

So far, semantic \aclp{ts} solutions have offered a sophisticated models with interesting additional features.
However, in most of the cases this is possible by delegating such tasks on a subset of more powerful and static nodes.
Therefore, the distribution of the space is restricted to some nodes when in the best case, or centralized in a unique node in the worst case.
In these cases, the rest of the nodes are head toward the use of the space as simple clients.


In this thesis we will explore the most decentralized case: the one in which each node manages its own information.
Doing so, a user can carry out his profile in the smart-phone or a sensor can provide the last measures on-demand.
% sólo tsc++ seguía esa premisa

% qué es necesario para cumplir esa visión y porque las alternativas vistas no se ajustan:
% dependencias mínimas, protocolos estándares, etc.


% TODO CONCLUSION
Although both semantic space-based and Triple Spaces implementations exist, none of them has been specifically designed to be run in devices with constrained capabilities apart from our solution.