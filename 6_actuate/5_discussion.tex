\section{Discussion}
\label{sec:actuation_discussion}


In the previous section we presented how the space-based approach can interoperate with semantically described \ac{rest} services.
The space-mediated communication transparently invokes \ac{rest} services on behalf of the consumer which follows the \ac{ts} usage patterns.
This section scrutinizes the strengths and weaknesses of the presented design, in conjunction with some other design alternatives. % design, alternative, etc.


%The \emph{glue} between both scenarios is the data used.


% mejor igual ponerlo después?

% Ontologies used
% explicar por qué hemos modelado así los escenarios?
% por qué con medidas?
% por qué uso preferencias?

% TODO explain why like this? why not directly sensors/light?

% por qué no se tienen en cuenta otras características como la localización o lo que sea => por simplificar
%   en el goal se podrían describir


% luego posiblemente se podrían medir algunos indicadores de los mismos
%   e.g. cuando código extra ha hecho falta añadir en el tercero para que se hablen entre sí



\subsection{Inputs for the Proof-based Actuation Mechanism}
\label{sec:inputs_proof}

The reasoning process presented by \citet{verborgh_ijcs_2014} uses as inputs: % presented by en vez de posesivo, porque "X et al.'s" queda como el culo
an initial state,
a goal state,
Web \ac{api} descriptions using \restdesc{}, and
optional background knowledge.
% inputs: clues
% goal: task


\begin{description}
  \item[The descriptions] must be read from the actuation nodes prior to reasoning. % obvio
        They can be read with a \emph{ad hoc} discovery mechanisms.
        However, in order to simplify the design of the middleware, it is sensible to use one of the already existing mechanisms:
        
        \begin{itemize}
	  \item An agent could discover the descriptions and simply write them in the coordination \Space{}. % y ahora habrá que definir que es un agente?
		Then, any node willing to reason will read them from the \Space{}.
	  \item The descriptions could be part of the \clues{} presented in Chapter~\ref{cha:searching}.
		This option ensures that they will be available in any \consumer{}.
		Besides, the static nature of these descriptions does not break the stability assumption of the \clues{}. % explicar más?
        \end{itemize}

  % TODO TODO TODO especificar que este mecanismo adicional de usar clues es optional y no el usado en nuestro escenario simple
  \item[The initial state and background knowledge] can be acquired both from the coordination space and the outer space.
	However, reading all the space would be highly inefficient.
	To reduce readings on the space (i.e. network usage), we propose a procedure composed by two reasoning steps.
	In the first one we only use local incomplete knowledge derived from the \clues{}.
	Then, we read from the \Space{} just the knowledge needed to confirm the pre-proofs obtained in the first reasoning.
	The second reasoning uses this knowledge to get real pre-proofs. % real o actual pre-proofs
	
	% Y ahora explicado en mayor detalle:
	Therefore, a node which wants to actuate over the space will need to obtain the \emph{clues} from the \ac{wp}.
	%These clues, as explained before, tell what kind of content other nodes provide. % un poco redundante
	Let us assume that these \emph{clues} are composed by the predicates used by the nodes which provide content. % es una de las alternativas que se planteaban
	The existence of a predicate used in a premise does not necessarily imply that this rule can be used.
	Nevertheless, its absence does imply that it will not be used (see Figure~\ref{fig:activation_rules}).
	Therefore, we can create temporary \emph{activation rules} from \clues{} which activate those potential rules. % latter rules las que se han mencionado primero

	\InsertFig{activation_rules}{fig:activation_rules}{
	  Sample clues, two rules and the activation rule created from the first rule.
	}{
	  According to the clues shown, the second rule will never be invoked.
	}{0.8}{}

	An \emph{activation rule} for a rule R contains a \emph{true} in the premise.
	The conclusion is made by R's premise substituting the variables with fictitious \acsp{uri} with a common prefix (see Figure~\ref{fig:activation_rules}).
	These fictitious \acsp{uri} are used to distinguish when a triple should be replaced by actual knowledge from the space. % explicar mejor?


  \item[The goal state] should be created from the task to reuse the primitives and the data from the \ac{ts}-based actuation mechanism.
	For instance, from a task of \emph{regulate temperature to 6ºC} we can deduce the goal state of \emph{temperature of 6ºC}.
	This translation is out of the scope of the dissertation.
\end{description}


\subsection{Responsibility for Triggering the Proof-based Actuation Mechanism}
\label{sec:responsible_proof}

Section~\ref{sec:background_restdesc} described two coarse-grained steps:
\begin{itemize}
  \item Reasoning over the descriptions, background knowledge, an initial state and a goal state.
        The result of the reasoning process if a pre-proof, which can be seen as a tentative \emph{execution plan} to achieve the goal.
  \item Check the execution plan by following it.
\end{itemize}


This mechanism can be performed by any node.
% no obligamos a implementar una u otra, pero recomendamos esto: XXX
This dissertation briefly explains three different alternatives and their trade offs.
However, we do not adhere to any of them.
We leave as a future work to implement and quantitatively compare them.

\begin{enumerate}
  \item An agent which resides in the same machine as the \emph{coordination space} can trigger the process. % TODO buscar su nombre bueno
	Doing so, it can locally consume the knowledge available in the \emph{coordination space}.
  \item A more flexible approach would consist of letting any \consumer{} interested on changing the environment to trigger it.
	If these \consumers{} use the search mechanism presented in the Chapter~\ref{cha:searching}, they will have background knowledge about other nodes.
	This reduces the dependency on the node providing the \emph{coordination space}. % TODO buscar su nombre bueno
	However, it requires them to perform tasks such as reasoning and checking the pre-proofs.
	While the latter increases the network usage, the first increases the computation.
	As we already mentioned in previous chapters, these tasks severely affect to the energy consumption.
	Furthermore, some resource platforms will not be even able to reason.
  \item To mitigate that problem, we could delegate this task only on the nodes able to perform such tasks.
	In fact, these nodes could follow the \emph{replicated-worker pattern}.
	They could read from the space goals to trigger the process (i.e. \emph{reasoning tasks}).
	Apart from balancing the load between all the worker nodes, any node can stop being worker at any time by not taking more \emph{tasks} (e.g. if it has low energy).
	These nodes must be \consumers{} to use the \clues{} from the search mechanism as background knowledge.
\end{enumerate}


% Poner ejemplo adaptado del paper de WoT2013?


%Proceso de suggest:

%\begin{itemize}
% \item obtener todo el conocimiento necesario para el proceso?
% \item razonamiento sobre conocimiento
% \item parsear el resultado para invocar servicios HTTP
% \item monitorizar que se ha complido el cambio?
%\end{itemize}