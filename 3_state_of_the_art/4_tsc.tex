\section{Semantic \aclp{ts}}
\label{sec:soa_tsc}

% TODO
% Añadir  Citron (2005)? (eoa de Almeida)
% Tanasescu
% swarm
% decir que tiene mucho que ver con distributed triple stores
% analizarlos también??? vaya pereza! -> igual comentar diferencia y dejar el análisis para la sección tosca de IGWS

Semantic \aclp{ts} aim to join \aclp{ts} with the \acl{sw} to propose a more uncoupled solution.
Particularly, it benefits from the autonomies introduced by both \ac{ts} and the \ac{sw}:

\begin{itemize}
  \item Space uncoupling.
  \item Time uncoupling.
  \item Data-schema uncoupling. % TODO TODO TODO explicar!!!! No se menciona en ningún otro lado!!!
% 	enhances the interoperability of the
% 	applications built on top of TSC. This way, two applications using standard ontologies can interact among them
% 	automatically enriching one each other, as long as they use the same space and standard and linked ontologies.
\end{itemize}


This section provides a review of the existing Semantic \aclp{ts} solutions. % TODO citar nixon_tuplespace-based_2008 ??? % mencionar que la nuestra es más completa/nueva
% así no nos repetimos como el ajo
Instead of describing each of these solutions individually and then include a comparison,
the review is divided in sections which describe the main aspects of a Semantic \ac{ts}.


\InsertFig{venn-sec3}{fig:venn_tuplespaces_semantics}{Semantic \aclp{ts}}{Scope of Section~\ref{sec:soa_tsc}.}{0.6}{}


% Definir constantes para referirnos a los distintos middlewares analizados
\newcommand{\midtsc}{\acs{tscm} \citep{fensel_tsc_2007}}
\newcommand{\midsws}{\acs{sws} \citep{tolksdorf_coordination_2006}}
\newcommand{\midstuples}{\acs{stuples} \citep{khushraj_stuples:_2004}}
\newcommand{\midcspaces}{\acs{cspaces} \citep{martinrecuerda_towards_2005}}
\newcommand{\midtscpp}{\acs{tscpp} \citep{krummenacher_open_2009,blunder_distributed_2009}}
\newcommand{\midtripcom}{\acs{tripcom} \citep{simperl_coordination_2007}}
\newcommand{\midsmartmt}{\acs{smartm3} \citep{honkola_smart-m3_2010}}
\newcommand{\midnardini}{\citet{nardini_semantic_2013}}


\subsection{Use of semantics}

The works analysed present two strategies to semantically annotate data: the use of \ac{sw} standards or the definition of their own language.
\ac{cspaces} \citep{martinrecuerda_towards_2005} and \citet{nardini_semantic_2013} define their own language-independent up to \ac{fol} notation.
% theoretical counterpart of OWL DL [7]. Since OWL is the W3C standard ontology description language for the Semantic Web,
% and the standard de-facto for semantic applications in general, we adopt OWL as the ontology language for the domain
% ontologies associated to ReSpecT semantic tuple centres in TuCSoN. While for the details of OWL we forward interested
However, these works face an inconvenience: most of the libraries and tools available are based on the \ac{sw} standards. % concretamente cuando quieren usar reasoners!
Therefore, they have to internally translate between both worlds in a not-straightforward and resource consuming manner. % son cosas distintas!


% TODO explicar diferencias, citar o evitar verengenales que no comprendo y que sólo me complican la vida?
% http://www.cs.ox.ac.uk/ian.horrocks/Seminars/download/Horrocks_Ian_pt1.pdf
%     DL == Decidable fragments of First Order Logic
% http://en.wikipedia.org/wiki/Description_logic#First_order_logic
%     Many Description Logic models (DLs) are decidable fragments of first order logic (FOL).
%     Some DLs now include operations (for example, transitive closure of roles) that allow efficient inference but cannot be expressed in FOL.


On the contrary, the majority of the semantic \acp{ts} use the metadata data model in which the \ac{sw} relies: \ac{rdf}. % también lo llaman language
We also opt for using the widely accepted \ac{rdf} to ensure interoperability \emph{ab-initio}.
On top of \ac{rdf}, the \ac{sw} defines new layers to increase the data expressiveness.
First, \ac{rdfs} \citeweb{rdfs2004} describes a series of classes and properties to define vocabularies in \ac{rdf}.
On top of \ac{rdfs}, \ac{owl}\citeweb{owl2004} offers additional vocabulary for describing properties and classes.
% 3 niveles: Lite, DL (que se corresponde con DL) y Full
These properties and classes allow to reason over the knowledge both to validate the data inserted or to infer implicit (unstated) knowledge. % implicit y unstated son redundantes, pero para que se entienda mejor


Although reasoning may be desirable, its use is tangential to the model proposed in this thesis.
In any case, it is by no means mandatory in our solution because:
\begin{itemize}
  \item The devices which may provide information to our \emph{federated space} are autonomous.
	They share a minimal contract with our middleware where we cannot define how they manage/provide their information.
  \item It is limited by the availability of reasoners, and nowadays there is no light enough reasoner to run in a reasonable time span in small devices.
        % TODO citar algo? quizá nuestro propio trabajo?
\end{itemize}
%For our solution, describing the data semantically is a first step towards semantically interpreting it.
%The Table~\ref{tab:comparisonSemantics} shows different features regarding the semantic model proposed by each solution.

\input{\pathchapthree/tables/semantics}


\subsection{Tuple model}

% presentamos distintos modelos
On the one hand, several works embed semantic content in one of the fields of a common tuple.
\ac{cspaces} \citep{martinrecuerda_towards_2005} defines seven-field tuples.
\ac{stuples} \citep{khushraj_stuples:_2004} extend the \emph{JavaSpace} \citep{freeman_javaspaces_1999} middleware adding a field with semantic content associated to the tuple object.
This content follows the DAML+OIL language (the \ac{owl} precursor).
\citet{nardini_semantic_2013} use the concept of \emph{semantic tuples} which are expressed in logic terms.


On the other hand, the most common tuple model is the three-field tuple which corresponds with a \ac{rdf} triple.
That is, a tuple with a field for the \emph{subject}, another for the \emph{predicate} and a third one for the \emph{object}.
% Sacado de la descripción de TSC que tenía antes:
% In a later work, \citet{krummenacher2006specification} proposed to use identifiers just for a set of triples (i.e. \ac{rdf} graphs).
% bundler cita el de "WWW: or what's wrong with the web" para explicar eso último
However, a triple by itself cannot express much information \citep{krummenacher2006specification}.
% también para reducir la complejidad del storage (TSC dixit)
% decir que al primero que se le ocurrió fue a TSC?
To solve this limitation, semantic \acp{ts} have usually adopted the concept of \ac{rdf} graphs too.
% En SWS usan algo muy parecido pero a lo que llaman subspace.
A \ac{rdf} graph is a set of \ac{rdf} triples identified by an \ac{uri}. % TSC distinguen entre NamedGraph (grafo con URI) y Graph (conjunto de grafos)
Although they can be accessed by their \ac{uri}, more interestingly, these middlewares also guarantee associative access. % see the next section

\input{\pathchapthree/tables/tuple_model}


\subsection{Query model}

In \ac{ts}, originally tuples were selected using special tuples where wildcard values were allowed in the fields. % simplificado, a veces también tipos
All the studied works which use a \ac{rdf} triple as a tuple follow this approach.
Beside, they provide access to the \ac{rdf} graphs by their \acp{uri}.

Most of these works also offer advanced query languages (e.g. SPARQL \citeweb{sparql2008}) as a more expressive way to match graphs.
These languages can be decomposed in plain triple patterns.
However, this requires a parser which may not be available for resource constrained platforms.
This dissertation focuses on queries based on graph patterns and leaves the adoption of more complex querying languages as a future enhancement.

\ac{cspaces}, \ac{stuples} and \citeauthor{nardini_semantic_2013} use less standard querying approaches.
\ac{cspaces} \citep{martinrecuerda_towards_2005} and \citet{nardini_semantic_2013} offer a formal language to select appropriate tuples.
\ac{stuples}\citep{khushraj_stuples:_2004} extends JavaSpace's template by adding assertional axioms that can be used to match semantic tuples.

\input{\pathchapthree/tables/query_model}


\subsection{Space model}
\label{sec:soa_tsc_space}

The \emph{flat} model offers independent disjoint spaces.
\ac{stuples}, \citet{nardini_semantic_2013}, TSC, tsc++ and Smart-M3 use this model.
% sTuples:
%    Bundler dice que es "Centralized nested", pero no sé de dónde lo saca
%    Está basado en Javaspaces, que por lo que puedo ver es flat
%    En nixon2008 sólo dicen que es centralized
% decir que quiere decir: Tuple Centres Spread over the Network ?
Within them, \citet{nardini_semantic_2013} present the most singular model.
It extends TuCSoN \cite{omicini_tucson:_1998}, which presents an evolution of the \ac{ts} called \emph{tuple centre}.
A \emph{tuple centre} can be adapted to the application needs through reactions to communication operations.
These reactions allow to trigger behaviours in response to any primitives or to define new ones.
% TuCSoN follows a flat model where different independent tuple centres can coexist at the same time. % o created?
% The agents can access to remote \emph{tuple centres} and migrate to them, but these interactions need to be programmed.
% Besides, the latter three works identify each space with an \ac{uri}.


% TODO Nosotros proponemos flat spaces enriquecidos con federated spaces
% Nested
More sophisticated models allow to create hierarchies of spaces.
Three examples are \ac{sws}, \ac{tripcom} \citep{simperl_coordination_2007} and \ac{cspaces}.
% SWS -> Disjoinnt nested
% cosas relativas al despliegue
\ac{sws} \citep{tolksdorf_coordination_2006} proposes two ways to partition the spaces: sub-spaces and contexts.
Sub-spaces are disjoint partitions of the main space.
Contexts enable to virtually divide the space into overlapping partitions.
These partitions are used to enable particular clients' views of the space.


However, probably \ac{sws}'s most distinctive feature is that it virtually divides the spaces into two views.
The \emph{data view} stores syntactically valid \ac{rdf} and it is accessed using Linda-like primitives.
The \emph{information view} stores consistent and satisfiable data which are managed using new primitives.
The latter view takes into account the knowledge defined by ontologies to perform semantic matching over inferred triples.


% TripCom
\ac{tripcom} shares some similarities with \ac{sws}'s model.
It uses subspaces to form nested multiple spaces.
Doing so it restricts the communication to a part of the whole space leading to scalability and completeness. % según ellos
Besides, it offers a mechanism to overlap spaces called \emph{scopes}.
Using \emph{scopes} a client can create a temporary copy of some tuples.
However, any insertion and deletion would not apply to the whole Triple Space.

% CSpaces
% On the contrary of C04 where modifications need to be approved by all
% subscribers, the updates proposed by the members of a Shared CSpace are
% automatically included, and versioning mechanisms are in charge to track
% changes and provide rollback features if one of the members disagrees with
% the included updates.
% To join a Shared CSpaces and publish and retrieve data on it the new
% members should first complete a registration procedure in which one of the
% main tasks is to provide a semantic and alignment specification between the
% data that each new candidate want to share and the data that previous
% members have published beforehand.
\ac{cspaces} \citep{martinrecuerda_towards_2005} proposes two types of spaces: individual and shared.
An \emph{individual space} belongs to a single process.
Two participants can agree on how to represent the knowledge to share their individual spaces forming a \emph{shared space}.
Shared spaces can join to others forming a tree structure.
In a shared space the updates are versioned and can be revoked by any member.
However, neither the registration process needed for the agreement or the revocation process are detailed.
Furthermore, to the best of our knowledge, this conceptual exercise never went beyond a rather limited prototype.


\input{\pathchapthree/tables/space_model}



\subsection{Distribution} % o después de space model o integrado!
\label{sec:soa_tsc_distribution}
%	2. centralizado / distribuído
%	4. basado en clientes tontos

\begin{sloppypar}
Participant nodes usually access to semantic spaces on client/server basis.
% no puedo usar \ac{} por la mayúscula
Tsc++\citep{krummenacher_open_2009,blunder_distributed_2009} proposes an exception to the client/server access to the space.
It relies on the Jxta P2P framework \citeweb{jxta} to propagate queries using different strategies.
In \acs{tscpp}, spaces correspond to groups of nodes which locally manage their data.
\end{sloppypar}


In client/server spaces, the back-end of the server can be distributed or centralized in a single machine.
Centralized \aclp{ts} are much simpler and easier to implement.
Therefore, they usually offer more features than the distributed ones.
However, they also impose a single-point-of-failure.


Within the distributed approaches we can distinguish those works which replicate data and those which do not.
\acs{tscm} belongs to the first group, and replicates all the triples in each deployed kernel.
In \ac{tripcom} each kernel stores one or more subspaces and can contact other kernels responsible for different spaces.
To do that, if the space's \ac{url} is provided, it simply resolves this \ac{url} using \ac{dns} and contacts the other kernel.
Otherwise, the kernel uses three additional strategies:
\begin{itemize}
  \item Triple Provider.
	It uses shortcuts to know who answered a query in the past.
  \item Recommender.
	It uses shortcuts to know which kernel successfully routed a query in the past.
  \item Indexing - \ac{dht}.
	It creates indexes using a hash function over the subject, predicate, object and space \ac{url}.
	Then, it stores these indexes in a distributed database which relies in a structured \ac{p2p} system. % mencionar PGrid???
\end{itemize}
\ac{cspaces} uses a similar but vaguely described super-peer network \citep{martinrecuerda_application_2006}.


As discussed in Section~\ref{sec:soa_ts_ubicomp}, we also deal with distribution of data in one of the spaces of our hybrid model.
As detailed in the following sections, we locally manage the content and we distribute the queries.
This resembles to the \emph{tsc++}'s strategy.
However, instead of using a \ac{p2p} framework to access to the contents,
we individually access to them using several \ac{http} requests. % añadir que son "parallel" o sólo liará?
In other words, each client may access to various server to obtain a result for a given primitive.

% TODO TODO TODO Smart-M3
% De: http://www.diem.fi/files/KP_reference%20implementation.pdf
%  The Semantic Information Broker is the information repository of the Smart 
%  Environment. In theory, the Smart-M3 Smart Space can consist of one or more SIB 
%  entities. However, the SIB reference implementation does not currently support any 
%  kind of interaction between different SIBs, which would enable distribution of the 
%  Smart Space. On the IOP, the SIB is implemented as a NoTA SN.
\citet{honkola_smart-m3_2010} defend that \acs{smartm3}'s space can be distributed using the \emph{distributed deductive closure protocol}.
 % TODO asegurarse 100% de esto que voy a decir!
However, to the best of our knowledge this idea has never been implemented or evaluated, making \acs{smartm3}'s space de facto centralized.
For the communication between the clients and the space, \acs{smartm3} defines a stateful protocol called \emph{Smart Access Protocol (SSAP)}. % decir que está basado en XML?
The authors defend that this protocol is communication agnostic because it can be implemented on top of different communication mechanisms
(e.g. WS-* web services, XMPP \citeweb{xmpp}, Bluetooth \citeweb{bluetooth} or TCP/IP).
\citet{kiljander_knowledge_2012} propose an enhanced stateless access protocol designed to fit the needs of low capacity devices.


\input{\pathchapthree/tables/distribution}


\subsection{Discussion}
\label{sec:soa_tsc_discussion}

% Model: Triple Space
The use of standard semantic protocols and \ac{rdf} triple-like tuples characterizes \acl{tsc}. % restringido a subconjunto de los trabajos analizados
% Originalmente TSC estaba basado en REST
\ac{tsc} was born to realign web services (WS-*) with the web.
To ensure this alignment, it was based on \ac{rest} architectural style's principles \citep{fensel_triple-space_2004,hernandez_formal_2010}. % se pueden poner otras intermedias: riemer2006tsc o fensel2007tsc
However, \ac{tsc} has never been true to all these principles. % porque según ellos había algunas cosas que ni de palo, de otras como HATEOAS simplemente se olvidaron
%no deliveradamente!
%fensel_tsc_2007
% Luego ha ido derivando e implementando funcionalidades más complejas alejandose del diseño inicial
%    => el interés por añadir features, hizo que la gente olvidase los ppios que guiaban la simplicidad de REST
Furthermore, the more features are added to the \ac{tsc} design (e.g. subscriptions or transactions), the more difficult it is to reconciliate both worlds.

%\subsubsection{Additional features}
%\input{\pathchapthree/tables/additional}


Regardless of their incompatibility with other features or practical technical difficulties, % e.g. conseguir HATEOAS o effective caching
we defend that, \emph{per se}, \ac{tsc} does not contradict in any sense the \ac{rest} principles described in Chapter~\ref{cha:background}:
% Ver cómo TSC puede cumplir con todos los principios de diseño
\begin{description}
 \item[\ac{restcs}.] Accessing to a space through a server in a \ac{restcs} fashion is completely feasible.
		      Indeed, this does not prevent to use a distributed solution in the \emph{back end} (e.g. a distributed semantic repository).
 \item[\ac{rests}.] The primitives to access the space imply simple reads and writes which do not store any state in the server.
 \item[\ac{restcache}. ] Despite of the difficulties detected by \citet{fensel_tsc_2007}, nothing prevents the semantic content stored in the space to be cached.
                          However, the dynamism of the knowledge can make effective caching challenging to achieve.
 %\item[\ac{rest_u}:] % lo quito porque si no, este punto sin texto con otros subpuntos queda feo
    %\begin{description}
	\item[\ac{restid}.]
			 In \ac{tsc}, there can be up to three type of resources which can be identified by an URI : spaces, \ac{rdf} Graphs and certain elements of the \ac{rdf} Triples.
	                 The space can be seen as a coarse-grained view of the underlying graphs.
	                 The graphs have sets of triples which are usually related and describe a unit of knowledge. % A RDF triple by itself cannot transmit too much information
	                 Self-identified triple's subjects, predicates or objects are the source of concept linking in the \ac{sw}.
	\item[\ac{restrep}.] The \ac{rdf} graphs and triples mentioned above can be represented using different standard serializations.
			      % TODO TODO TODO citar el paper que habla de cómo alinear LOD y REST
	\item[\ac{restdesc}.] The messages derived from the primitives are self-describing since they are expressed on standard \ac{rdf}-based languages. % including meta-data
				Therefore the server and clients know how to process the content according to its language and certain vocabularies.
				These vocabularies specifications (i.e. ontologies) are referenced in the content.
	\item[\ac{resthateoas}.] The lack of native hypermedia support in \ac{rdf}-based representations makes this the most challenging property to achieve \citep{page_rest_2011}. % compara LOD y REST
				  However, some recent works propose means to fulfil this property.
				  \citet{kjernsmo_necessity_2012} proposes a vocabulary for hypermedia \ac{rdf}.
				  \citet{steiner_fulfilling_2011} and \citet{verborgh_functional_2012} propose to enrich the \ac{http} header with hypermedia information.
				  While the first changes representations, the latter is a more general way to provide hypermedia.
    %\end{description}
 \item[\ac{restl}.] Encapsulation of functionalities can be achieved through a layered system.
                     For example, to balance the load to a space replicated in two machines.
 % TODO TODO repensar si ontologías, reglas y demás (personalizar behaviour) se puede entender cómo COD:
 % In the code-on-demand style [50], a client component has access to a set of resources, but
 %  not the know-how on how to process them. It sends a request to a remote server for the
 %  code representing that know-how, receives that code, and executes it locally.
 \item[\ac{restcod}.] There are several cases where the \emph{know how} can be downloaded from the server in \ac{tsc}: % ok, no tan común como scripting
            \begin{enumerate}
	      \item Modelling scripts using appropriate ontologies. % TODO cite
	      \item A semantic reasoner can be considered an interpreter for the content downloaded from the server.
	            It is used to extract unstated information from the content received from the server.
	            Therefore, the client downloads know-how to process the resource in the following situations:
		    \begin{itemize}
		      \item Through the taxonomies defined in ontology files. % e.g. para hacer un mapeo; en analogía a JS, da igual que tu tengas previamente el script o no
		            These taxonomies are modelled using standard semantic languages. % hablar de distintos niveles de expresividad?
		      \item Through semantically expressed rules \citep{berners-lee_n3logic:_2008}. % (e.g. N3 rules)
		    \end{itemize}
	      % con nuevo TBox que te bajas??
            \end{enumerate}
\end{description}


Table~\ref{tab:rest_principles} shows the conflicts that the analysed works present with these principles.
None of them achieve the \ac{resthateoas} principle.
In fact, its use in the \ac{sw} is subject of current research.
Most of them guarantee the access to the space in the \ac{restcs} basis.
The only exception is \midtscpp{}, where each participant of the space is a peer in a \ac{p2p} network.
Finally, the statefulness of these middlewares conflicts with additional features such as transactionality or subscriptions/notification systems.
While the transactionality need in \ac{tsc} can be argued,
subscriptions are useful to ensure certain level of asynchrony in the system (see Section~\ref{sec:notification}).
% explicar que lo nuestro al dividir en dos espacio en uno nos libramos de esto y en el otro es opcional para mejorar la eficiencia


% tabla de potenciales problemas con REST de los trabajos presentados:
\input{\pathchapthree/tables/rest_principles}


% Nosotros proponemos una vuelta a los origenes para recuperar una simplicidad de la que limited devices pueden beneficiarse
%    => la clave para facilitar y en algunos casos posibilidar que los dispositivos constrained lo implementen
This dissertation proposes a return to the origins to recover the simplicity loss in the previous works.
The rationale behind this decision is that resource constrained devices will benefit from this simplicity.
In the proposed middleware they will be able not only to write and read knowledge into an external space, but also to enrich it providing their own managed data.
% In the rest of the cases, the nodes are head toward the use of the space as simple clients.
% none of them has been specifically designed to be run in devices with constrained capabilities apart from our solution.
%      => la prueba de eso podría ser un apéndice con cómo lo nuestro se ha implementado en distintos cacharros... ¿?
% TODO TODO TODO explicar en qué consiste esto de simplicidad y por qué no es stateful?!