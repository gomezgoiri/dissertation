\section{Conclusions} % TODO llamarlo Evaluation?

With the solution presented in the previous section, we aimed to retain the desirable properties of both \ac{rest} and \ac{tsc}.
% analísis más largo en la siguiente sección
% 1. cómo sé que esto es mejor que usar REST y TSC por separado? Sinergia?
% 2. que aporta unirlo bajo un mismo middleware?
% 3. tiene beneficios?
However, some questions arise from that integration:
(1) does in fact retain all the properties of \ac{rest} and \ac{tsc} separately? Otherwise, which properties are affected?
(2) what other benefits carries comparing with using existing \ac{tsc} and \ac{rest} middleware?


% TODO cosas rescatables del paper original de WoT 2011:
%     Uniform API vs. specific usage of each API !!!
%     Coupling: lo comido (autonomies), por lo servidor (client-server coupling por tener API común)
%          In spite of the outlined decoupling nature of both approaches, the data definition can be considered a coupling mode indeed.
%          While in \ac{wot} each resource defines its own data formats and contents themselves, in \ac{tsc} the ontology in which the semantic
%          concepts are described must be known by each part of a distributed application to effectively cooperate among them.
%     Discovery: HATEOAS puede ser complejo para cacharros peques (parseo),
%                proponemos discovery basada en API uniforme y a nivel de cacharros con algún mecanismo en el que no entramos.
%          One of the main drawbacks in \ac{wot} is the lack of a discovery mechanism for new objects and the data they provide.
%          Even when this data can be linked in each object response (using HATEOAS) and microformats are sometimes included to ease the search-ability of these objects by search engines, it is difficult for an object which may change of location and context to be referred.
%          Thus, \ac{wot} may have a tendency to create isolated islands of data.
%          Several workarounds have been proposed to overcome this limitation, such as using a central repository\footnote{http://www.pachube.com/}, a framework which uses federated repositories responsible for different administrative domains \citep{stirbu_towards_2008} or making each connected sensor announce itself to let an intermediary know its presence \citep{kamilaris_smart_2010}.

%     Scalability: se ha hablado y ahora no es tan mala como antes ;-) Entre cacharros seguiría dando asco
%     Semantics: Microformats vs Full (hablar de esto)
%     Comprensión por parte de usuario: sencillo misma interfaz, no tienes que andar descubriendo nuevas APIs y viendo cómo funcionan, qué formato devuelven, etc.
%     Comprensión por parte de desarrollador: API sencillica siempre



\subsection{Network-based Style} % Architectural Properties for Network-based Styles
\label{sec:network_properties}
% Cómo afecta la app propuesta => ir actualizando al final de otras secciones???

In Section~\ref{sec:tsc_vs_rest} we have described how \ac{tsc} does not contradict any of the \ac{rest} principles.
However, the adaptation presented in this thesis does not completely adheres to the \ac{rest} style.
In this section we present how this divergences affect the \ac{rest}'s properties.
% decir que el objetivo final es que pudiera ser REST

% TODO antes de entrar al lio, explicar cómo funciona esto de REST, en qué parte de nuestra solución lo necesitaremos
% decir que API para TSC mola
% decir que API para los cacharros deberia de ser independiente a lo que nosotros digamos y por eso estaria bien REST
%     de todas formas, como es dificil, nos quedamos en un nivel de madurez menor


In \citeauthor{fielding_architectural_2000}'s words, the relevant properties which describe a network-based system are the following ones \footnote{We refer to the reader to \citet{fielding_architectural_2000} for the complete thorough analysis.}:
% verificar que no se parece demasiado a sus definiciones o sino poner cursiva.
\begin{description}
  \item[Performance] is divided into network performance, user-perceived performance and efficiency.
		    The first is affected by the styles in the number of interactions and the granularity of data elements.
		    The second property refers to the impact a user in front of an application perceives. % UP Performance es una feature que no aporta mucho a nuestro caso
		    The third is achieved by minimizing the use of the network.
  \item[Scalability] measures how an architecture supports a big amount of components and interactions between them.
  \item[Simplicity] is achieved through the separation of concerns for the components and the generality of architectural elements.
  \item[Modifiability] encompasses evolvability, extensibility and customization.
		      The first refers to the degree in which a component can be implemented without negatively impacting on others.
		      The second measures the ability to add functionality to the system.
		      The third is the ability to customize the behavior of an architectural element temporarily.
  \item[Configurability] is related with the extensibility and the reusability.
  \item[Reusability] is the ability to reuse components, connectors or data elements without modifying other apps.
  \item[Visibility] is the ability of a component of monitoring or mediating in the interaction between other two components.
  \item[Portability] is the ability of working in different environments.
  \item[Reliability] is the degree in which an architecture depends on the failures of the system or components, connectors or partially incorrect data.
\end{description}

% Requisitos de ealy web, propiedades deseables
%   Low entry-barrier
%   Extensibilidad
%   Distributed Hypermedia
%   Internet-scale

The Table~\ref{tab:network_properties} summarizes how different architectural styles achieve these properties.
Particularly, it shows the styles from which \ac{rest} derives (see Section~\ref{sec:rest}).
The ultimate goal of the solution explained in the previous section is twofold:
\begin{enumerate}
  \item Provide a \ac{rest} access to a semantic space.
       This would ease its integration with the rest of the web.
  \item Enrich that space with the knowledge provided by other \ac{rest} \acp{api}.
\end{enumerate}
Therefore, ideally, its networking properties would be the sames as the \ac{rest} style.


However, defining a 100\% \ac{rest} compliant \ac{api} is not easy.
Indeed, most of the self-proclaimed \ac{rest}ful \acp{api} are not \citep{house_how_2012}. % la nueva buzz word para eso: hypermedia API
The main cause is the \emph{HATEOAS} constraint seen in the Section~\ref{sec:rest} \citep{fielding_rest_2008}.
Using \ac{http} as an application-level protocol forces a developer to comply the rest of the constraints \citet{moore_hypermedia_2010}, but not \emph{HATEOAS}.
% TODO hablar del Richardson Maturity model!


% semantic-based \ac{api} is not easy. => referencias a los que lo han intentado, a que no hay hipertexto, a que te puede interesar inferir con bastantes
Regarding the \ac{sw}, some recent efforts have tried to move closer to the \ac{hypermedia} constraint \citep{steiner_fulfilling_2011,kjernsmo_necessity_2012}.
However, these worlds remain quite isolated.
In fact, \ac{sw} API  usually present another main divergence with the \ac{rest} style: the use of query endpoints.
% i.e. no devuelven listas de enlaces, sino todo a lo bruto
% esto quiere decir que no se devuelve todo y ala, tu procesa esa burrada de datos, más bien se filtran
These endpoints intend to solve some inefficiency issues which \ac{rest} shows when working with a big amount of data. % TODO mencionar \ac{lod} en algún punto de aquí?
To that end, they allow expressive query languages and offer results where the boundaries of the different resources often blurs \citep{wilde_restful_2009}.
The most paradigmatic case may be to decide to which graph does a inferred content belongs. % ejemplo de lo anterior


% Aterrizar esto a IoT y a nuestro caso:
%        La eficiencia es importante => para evitar hacer 500 llamadas a un cliente
%        La reusabilidad es importante también => para potencialmente adaptarse a cualquier WoT semántico
%           en el futúro => más trabajo en este área
%       Solución de compromiso:
%           nivel de madurez X de Richardson. Suponemos que alguien debe serguir nuestro API mínimo en los objetos WoT

In \ac{iot} both the efficiency on the communications and reusability of the \ac{api} are important:
\begin{description}
  \item[Efficiency:] mobile and embedded devices' have restricted energy autonomy.
                    This autonomy is severely affected by network communications. % TODO cite
                    Particularly, the access to the data they provide by means of hyperlinks may result in many HTTP requests. % aunque eso se puede adaptar por lo visto
                    %  Por que sería muy costoso hacer rollo araña?!
		    %     lo que ganas de reusabilidad, lo aumentas en complejidad en el cliente
                    %     interpretar código del servidor no es tampoco super-sencillo (xHTML!)
  \item[Reusability:] due to the heterogeneity of the devices, assuming that they all share a common and unevolvable \ac{api} may not be realistic. % TODO paliar para que no parezca que no tiene sentido
\end{description}
The first solution together with the current difficulties on achieving a fully and standard \emph{HATEOAS} for machines in the \ac{sw}, lead us to opt for the second level on the Richardson Maturity level.
Besides, our \ac{tsc} \ac{api} will be \emph{HATEOAS} \ac{api} in its humans representation to ease their learning level.% pero aún así el API de TSC seguirá siendo HATEOAS para los usuarios, no para las máquinas
However, we do not discard to work towards a fully \ac{rest}ful \ac{api} as future work.


In conclusion, the properties of the properties for network communication style we adopted corresponds with \emph{LCODC\$SS} plus simplicity and visibility. % hacer una nueva fila con esto
% TODO comprobar que se explica eso tal cual en la tesis de Fielding: HATEOAS => sólo afecta a reusabilidad

% TODO Comprobar que no se salga por el borde derecho!
\input{\pathchapthree/tables/network_properties}



\subsection{Middleware Properties}

A middleware is a software layer which provides a higher level of abstraction and masks the underlying heterogeneity.
The middleware presented in this thesis is oriented for \ac{ubicomp} environments and the devices which populate them (i.e. mobile and embedded devices).
Whereas the devices part of the \ac{iot} are a subset of the ones present in \ac{ubicomp}, we consider that the challenges they have to face are the same ones.
For instance, smartphones are not part of the \ac{iot}, but face similar energy and computational limitations as the embedded devices. % posiblemente no todas las propiedades!


%   qué propiedades deseables para IoT añadiría TSC (per se)
Therefore, we will adhere to the challenges presented by the \emph{Internet-of-Things Architecture} European project \citep{walewski_project_2011} to analyze our solution.
\citeauthor{walewski_project_2011} state that the \ac{iot} must overcome the following challenges:
\begin{description}
  \item[Interoperability:] to face the heterogeneity of technologies in the \ac{iot}.
  \item[Scalability:] to cope with a greater amount of devices.
  \item[Manageability] of the devices.
  \item[Mobility:] ability to face these situations.
  \item[Security and privacy]
  % definición de reliability modificada yendo a la fuente de iot-a.eu
  \item[Reliability:] to handle connectivity losses in various \emph{ad hoc}-like ways.
\end{description}
Furthermore, these devices also face energetic and computational constraints.


As shown in the Table~\ref{tab:middleware_netprop}, some of these properties closely relate with some of the ones explained in the previous section.
Some of these properties are repeated (\emph{scalability} and \emph{reliability}).
Others relate in non-self-explanatory ways (\emph{interoperability}, \emph{manageability} and \emph{energy and computational restrictions}).
Finally, some properties just relate indirectly.

% explicar por qué
% simplicidad siempre beneficia a alguno... :-S
Regarding the \emph{interoperability}, we defend that relates with the 

% TODO Comprobar que no se salga por el borde derecho!
\input{\pathchapthree/tables/middleware_netprop_map}

% explicar cómo HTTP trataba de evitar complejidades
% explicar como al crear una capa por encima, complicas todo un poco
%       sencillez
%       user-based library vs a lo otro

% Propiedades que jodes de HTTP de cara al usuario: simplicidad...
% propiedades de cara al usuario:
% Requisitos de ealy web, propiedades deseables
%   Low entry-barrier
%   Extensibilidad
%   Distributed Hypermedia
%   Internet-scale


%   features añadidas por TSC (valuable properties aportadas)
%   utiles para IoT


A middleware is a software layer which provides a higher level of abstraction and masks the underlying heterogeneity.
\ac{http} is a middleware indeed, but sacrifices masking exceptions on behalf of the simplicity. % TODO checkear con la tesis de Fielding
% TODO hablar de user-based library vs a lo otro
The success of libraries and tools for \ac{http} can be found in this simplicity.

Anyhow, we propose another abstraction layer on top of \ac{http}.
Specifically, we propose a space-based middleware.
By using some basic primitives, we encourage sharing data in resource constrained devices through an \ac{http} \ac{api}.
This \ac{api} also promotes reusing data from other applications build on top of that middleware.
Furthermore, encapsulating semantic from third \ac{rest} applications is as straightforward as implementing a simple \ac{api} on top of them.

% Future work: eliminar la necesidad de espacios?
By using semantic data, we try to improve application-level interoperability.
However, the use of \emph{spaces} goes against this goal.
As explained in Section~\ref{sec:tsc_soa} their use is justified in terms of scalability.



% \subsection{Querying Distributedly over the Space} => optamos por no meternos en jardines y up to the middleware implementer to decide each ;-)
% TODO condiciones relajadas: consistencia, razonamiento distribuído
% out of the scope: cómo implementarlo
% optaremos por lo más sencillo




\subsection{Summary}

In the previous sections we have get to the bottom of the strengths and weaknesses of our proposal.
To sum up, the main limitations are X and Y.
On the other hand, we can XXX.
Table~\ref{x} shows these and other aspects.

% Ventajas de meclar 2 cosas aparentemente separadas?
%   Para WoT:
%      comunicación indirecta para cacharros
%          local+ref
%              de contenidos relativos a coordinación
%              podríamos cachear contenidos de otros en el espacio central (reliability+energy)
%          ref
%              sacar a colación los problemas aquellos de query sobre muchos recursos
%
%   Para TSC (respecto a otras como Smart-M3):
%      limitamos qué gestiona la entidad central => sólo coordinación, el resto lo coge de los cacharros
%      se reconoce su autonomía permitiendo gestionarse su propio contenido => REST, escalabilidad
%      interop => SW y posibilidad de extender a otros servicios REST
%      multiplataforma => facilidad para portarlo
%
%   Para desarrollador:
%      API integrada y simple